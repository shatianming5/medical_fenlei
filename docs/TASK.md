# 任务定义与模型选择

## 任务是什么？

这是一个 **医学影像诊断分类** 任务：输入为颞骨/耳部 CT 的 DICOM 序列（3D 体数据），输出为 **每只耳朵（左/右）的诊断类别**。

本项目把一次检查的序列按图像宽度一分为二得到左右耳区域（右耳默认做水平翻转以对齐方向），然后对 **单耳** 做 6 分类：

| 类别 ID | 标注代码 | 名称 |
|---:|---:|---|
| 0 | 1 | 慢性化脓性中耳炎 |
| 1 | 2 | 中耳胆脂瘤 |
| 2 | 3 | 分泌性中耳炎 |
| 3 | 4 | 胆固醇肉芽肿 |
| 4 | 5 | 正常 |
| 5 | 6 | 其他 |

标注来源：`metadata/导出数据第1~4017条数据20240329-To模型训练团队.xlsx`（仅本地使用，不入库）。

## 为什么要做 1% / 20% / 100% 三层？

用于观察 **数据量缩放** 对模型效果的影响，并快速验证 pipeline：

- 1%：最小可跑通/快速迭代
- 20%：中等规模，用于模型对比
- 100%：最终训练

本项目使用 `scripts/make_splits.py` 对训练集做 **按类别分层等比例抽样**（每个类别按相同比例下采样，并设 `min_per_class` 避免 1% 时缺类），验证集固定不变，便于公平对比。

## 模型选什么？

数据是 CT 体数据（3D），但体数据训练开销大；因此建议从轻到重：

1) `slice_mean_resnet18`（默认基线）
- 做法：对抽取的 K 张切片逐张用 2D ResNet18 分类，然后对 logits 做 mean pooling
- 优点：训练快、显存小，适合 1%/20% 快速跑 baseline
- 入口：`scripts/train_side.py --model slice_mean_resnet18`

2) `resnet10_3d`（更匹配 3D CT）
- 做法：把 K 张切片堆成体数据 (D=K)，用 MONAI 的 3D ResNet10 做分类
- 优点：利用 3D 上下文，适合 20%/100% 冲效果
- 入口：`scripts/train_side.py --model resnet10_3d`

